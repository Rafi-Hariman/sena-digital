<body>
  <div class="modal-custom" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <button type="button" class="close-btn" aria-label="Close" (click)="closeModal()">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
        stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="bi bi-x" viewBox="0 0 24 24">
        <line x1="18" y1="6" x2="6" y2="18" />
        <line x1="6" y1="6" x2="18" y2="18" />
      </svg>
    </button>

    <div class="success-icon-wrapper">
      <div class="success-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
          stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M20 6L9 17l-5-5" />
        </svg>
      </div>
    </div>

    <h2 id="modalTitle" class="fw-semibold fs-5 text-dark text-center text-sm-start mb-3">
      Tambah Kategori Website
    </h2>

    <form [formGroup]="categoryForm">
      <!-- Nama Kategori -->
      <label for="nama_kategori" class="form-label fw-semibold text-dark fs-6 mb-2 d-block">
        Nama Kategori <span class="text-danger">*</span>
      </label>
      <div class="input-group mb-1">
        <input 
          type="text" 
          id="nama_kategori" 
          class="form-control" 
          [class.is-invalid]="isFieldInvalid('nama_kategori')"
          placeholder="-- Ketik nama kategori --" 
          formControlName="nama_kategori" />
      </div>
      <div *ngIf="isFieldInvalid('nama_kategori')" class="text-danger small mb-2">
        {{ getFieldError('nama_kategori') }}
      </div>

      <!-- Slug -->
      <label for="slug" class="form-label fw-semibold text-dark fs-6 mb-2 d-block">
        Slug <span class="text-danger">*</span>
      </label>
      <div class="input-group mb-1">
        <input 
          type="text" 
          id="slug" 
          class="form-control" 
          [class.is-invalid]="isFieldInvalid('slug')"
          placeholder="-- Ketik slug --" 
          formControlName="slug" />
      </div>
      <div *ngIf="isFieldInvalid('slug')" class="text-danger small mb-2">
        {{ getFieldError('slug') }}
      </div>

      <!-- Image Upload -->
      <label for="image" class="form-label fw-semibold text-dark fs-6 mb-2 d-block">
        Gambar Kategori
      </label>
      <div class="mb-3">
        <input 
          type="file" 
          id="image" 
          class="form-control" 
          accept="image/jpeg,image/png,image/jpg,image/gif"
          (change)="onImageSelected($event)" />
        <small class="text-muted">Format: JPEG, PNG, JPG, GIF. Maksimal 2MB.</small>
      </div>

      <!-- Image Preview -->
      <div *ngIf="imagePreview" class="mb-3">
        <label class="form-label fw-semibold text-dark fs-6 mb-2 d-block">Preview Gambar</label>
        <div class="position-relative d-inline-block">
          <img [src]="imagePreview" alt="Preview" class="img-thumbnail" style="max-width: 200px; max-height: 150px;">
          <button 
            type="button" 
            class="btn btn-danger btn-sm position-absolute top-0 end-0" 
            style="transform: translate(50%, -50%);"
            (click)="removeImage()">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <!-- Status -->
      <div class="form-check mb-4">
        <input 
          class="form-check-input" 
          type="checkbox" 
          id="is_active"
          formControlName="is_active">
        <label class="form-check-label fw-semibold text-dark" for="is_active">
          Aktif
        </label>
      </div>
    </form>

    <div class="d-flex gap-3">
      <button 
        type="button" 
        class="btn btn-outline-gray flex-fill py-2 fs-6" 
        (click)="closeModal()"
        [disabled]="uploading">
        Cancel
      </button>
      <button 
        type="button" 
        class="btn btn-purple flex-fill py-2 fs-6" 
        (click)="onAddCategory()"
        [disabled]="uploading || categoryForm.invalid">
        <span *ngIf="uploading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        {{ uploading ? 'Creating...' : 'Confirm' }}
      </button>
    </div>
  </div>
</body>