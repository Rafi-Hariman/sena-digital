<div class="rp-container">
  <!-- Payment Method Selection -->
  <div class="rp-form-group">
    <label for="payment_method" class="rp-label">Metode Pembayaran</label>
    <div class="rp-select-wrapper">
      <ngx-select [items]="selectOptions.payment.items" 
                  [optionTextField]="'name'" 
                  [optionValueField]="'id'"
                  placeholder="Pilih metode pembayaran" 
                  (select)="onMetodeSelect($event)"
                  class="rp-select">
      </ngx-select>
    </div>
  </div>

  <!-- Manual Payment Method -->
  <ng-container *ngIf="selectedMethod === 1">
    <div *ngFor="let rekening of bill" class="rp-payment-section">
      <!-- Bank Name -->
      <div class="rp-form-group">
        <label class="rp-label">Nama Bank Tujuan</label>
        <div class="rp-readonly-field">
          {{ rekening.nama_bank }}
        </div>
      </div>

      <!-- Account Number -->
      <div class="rp-form-group">
        <label class="rp-label">Nomer Rekening</label>
        <div class="rp-readonly-field rp-copyable" (click)="copyToClipboard(rekening.nomor_rekening)">
          <span>{{ rekening.nomor_rekening }}</span>
          <svg class="rp-copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
      </div>

      <!-- Owner Name -->
      <div class="rp-form-group">
        <label class="rp-label">Nama Pemilik</label>
        <div class="rp-readonly-field">
          {{ rekening.nama_pemilik }}
        </div>
      </div>

      <!-- Amount -->
      <div class="rp-amount-section">
        <div class="rp-amount-row">
          <span class="rp-amount-label">Nominal yang harus dibayarkan:</span>
          <span class="rp-amount-value">Rp. {{ manualBill }}</span>
        </div>
      </div>

      <!-- Instructions -->
      <div class="rp-instructions">
        <p>Setelah melakukan pembayaran, pastikan Anda klik "Lanjut" untuk langkah selanjutnya. Mohon untuk menyimpan bukti pembayaran.</p>
      </div>
    </div>
  </ng-container>

  <!-- Tripay Payment Method -->
  <ng-container *ngIf="selectedMethod === 2">
    <div *ngFor="let tripayData of bill" class="rp-payment-section">
      <h3 class="rp-section-title">{{ tripayData.methode_pembayaran }}</h3>
      
      <div class="rp-form-group">
        <label class="rp-label">API Key</label>
        <div class="rp-readonly-field rp-copyable" (click)="copyTripayToClipboard(tripayData.api_key)">
          <span>{{ tripayData.api_key }}</span>
          <svg class="rp-copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
      </div>

      <div class="rp-form-group">
        <label class="rp-label">Private Key</label>
        <div class="rp-readonly-field rp-copyable" (click)="copyTripayToClipboard(tripayData.private_key)">
          <span>{{ tripayData.private_key }}</span>
          <svg class="rp-copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
      </div>

      <div class="rp-form-group">
        <label class="rp-label">Kode Merchant</label>
        <div class="rp-readonly-field rp-copyable" (click)="copyTripayToClipboard(tripayData.kode_merchant)">
          <span>{{ tripayData.kode_merchant }}</span>
          <svg class="rp-copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
      </div>

      <div class="rp-form-group">
        <label class="rp-label">URL Tripay</label>
        <div class="rp-readonly-field">
          <a [href]="tripayData.url_tripay" target="_blank" class="rp-link">{{ tripayData.url_tripay }}</a>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Midtrans Payment Method -->
  <ng-container *ngIf="selectedMethod === 3">
    <div *ngFor="let midtransData of bill" class="rp-payment-section">
      <h3 class="rp-section-title">{{ midtransData.methode_pembayaran }}</h3>

      <div class="rp-form-group">
        <label class="rp-label">Server Key</label>
        <div class="rp-readonly-field rp-copyable" (click)="copyMidtrans(midtransData.server_key)">
          <span>{{ midtransData.server_key }}</span>
          <svg class="rp-copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
      </div>

      <div class="rp-form-group">
        <label class="rp-label">Client Key</label>
        <div class="rp-readonly-field rp-copyable" (click)="copyMidtrans(midtransData.client_key)">
          <span>{{ midtransData.client_key }}</span>
          <svg class="rp-copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
      </div>

      <div class="rp-form-group">
        <label class="rp-label">Metode Production</label>
        <div class="rp-readonly-field rp-copyable" (click)="copyMidtrans(midtransData.metode_production)">
          <span>{{ midtransData.metode_production }}</span>
          <svg class="rp-copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
      </div>

      <div class="rp-form-group">
        <label class="rp-label">URL Setting</label>
        <div class="rp-readonly-field">
          <a [href]="midtransData.url" target="_blank" class="rp-link">{{ midtransData.url }}</a>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Trial Method -->
  <ng-container *ngIf="selectedMethod === 4">
    <div class="rp-trial-section">
      <p class="rp-trial-text">
        Anda memilih metode "Trial dulu" sehingga masa uji coba hanya berlangsung selama 3 hari. 
        Beberapa fitur tidak akan tersedia di akun Anda. Setelah masa uji coba habis, 
        Anda tidak dapat lagi mengakses undangan yang Anda buat.
      </p>
    </div>
  </ng-container>

  <!-- Navigation Buttons -->
  <div class="rp-button-group">
    <button type="button" class="rp-btn rp-btn-secondary" (click)="onBack()">
      Kembali
    </button>
    <button type="button" class="rp-btn rp-btn-primary" (click)="onNextClicked()" [disabled]="!selectedMethod">
      Lanjut
    </button>
  </div>
</div>